---
date: 2021-04-15
title: "제어시스템과 PID 제어 정리"
categories: Embedded_HW
tags: jekyll
toc: true  
toc_sticky: true 
---

제어시스템과 PID 제어 정리
=============

제어시스템 개론과 PID 제어에 대한 전반적인 내용 정리.

# 0. 제어시스템
## 0.1 제어시스템의 개론
제어시스템을 이해하려면 아래의 기본적인 개념들에 대한 정의를 알고 있어야함.    

1. 시스템(System)
    * 특정 동작을 수행하는 모든 것을 통칭하는 말
2. 플랜트( **P** , plant, 제어대상시스템, system to be controlled, process)
    * 어떤 기능을 수행하는 물리적 시스템
    * **제어하는 대상** 을 지칭함.
        * ex : 모터, 자동차, 비행기, 선박 등 등
    * 입력(input, 제어신호( **u** ), control input)과 출력(output, 제어변수( **y** ), system output)을 가짐.
3. 제어기( **C** ,controller, system to control, 보상기, compensator, DSP)
    * 제어 목표를 수행하고자 고안된 시스템
    * 기준입력( **r** )(엄밀히 말하면 오차( **e** ))을 통해 제어신호( **u** )를 생성하여 플랜트( **P** )를 구동
4. 되먹임제어(Feedback Control, 궤환제어)
    * 플랜트( **P** )의 출력( **y** )를 사용하여 제어신호를 생성하는 기법
    * 외란(disturbance)이 존재할 때, 출력( **y** )과 기준입력( **r** )을 비교하여    
      그 차이를 감소시키도록 하는 작동.
5. 강인성(robustness, 견실성)
    * 아래의 몇가지 경우의 조건에도 불구하고, 원하는 성능을 유지하는 능력
    1. 불확실성(uncertainty)
    2. 외란(disturbance)
        *  출력( **y** )에 나쁜 영향을 미치게 하는 신호
    3. 잡음(noise)
6. **제어시스템(Control System)**
    * 제어기( **C** )와 플랜트( **P** )가 결합된 형태의 시스템을 통칭하는 용어
    * 제어변수( **y** )를 측정, 측정값이 기준입력( **r** )에 가까워지도록    
      제어신호를 만드는 동작을 수행함.
    * 강인성(robustness)을 보장하기 위해 되먹임제어(Feedback Control, 폐루프(Closed-loop))도 구성함.    

![image](https://user-images.githubusercontent.com/79636864/114800515-d2c9cc00-9dd4-11eb-8cf2-234ddc2a94b7.png)    


## 0.2 제어시스템의 목표    
### ● 제어변수( **y** )가 기준입력( **r** )에 가까워지도록 제어기( **C** )를 설계하는 것!
### ● 강인성(robustness)을 보장할 것!  
### ● 폐루프제어(Closed-loop)의 단점인 안정도를 고려할 것!


1. 제어시스템의 장점
    * 불확실성(uncertainty) 과 외란(disturbance)에 강함
    * 덜 정확하고 저비용 부품으로 성능 보장
2. 제어시스템의 단점
    * 안정도를 고려해야함.    

## 0.3 제어시스템의 전형적인 단위계단응답
![image](https://user-images.githubusercontent.com/79636864/114806926-7b315d80-9de0-11eb-912b-4edbdb23fb9a.png)    


# 1. PID 제어
## 1.1 PID 제어의 정의
### ● 기준입력( **r** )과 측정된 출력( **r_now** )의 차이인 오차( **e** )를 이용한
### ● 비례(Proportional, P), 적분(Integral, I), 미분(Differential, D)을 통해    
### ● 제어에 필요한 제어값(MV : Manipulated Variable)을 계산하여    
### ● 제어신호( **u** )를 만드는 제어기    

![image](https://user-images.githubusercontent.com/79636864/114803737-fb54c480-9dda-11eb-86c9-4b66c213f8c9.png)    

* 일반적인 PID제어기는 3개의 항(P, I ,D)를 더해서 제어값(MV)을 계산하도록 구성.    

![image](https://user-images.githubusercontent.com/79636864/114803755-04459600-9ddb-11eb-8e5f-266a75dc1d18.png)    

1. e(t) : 경과시간에 따른 오차( **e** )값.

## 1.2 P제어
* 현재 제어값(MV)이 오차( **e** )에 비례하여 변화시키는 방법
    * 오차( **e** )의 크기에 따라 제어신호( **u** )가 달라짐.

1. Kp가 크면
    * 제어시스템은 점점 더 빨리 기준입력( **r** )에 도달하게 됨.
    * 단, **불안정한 상태** 가 되고 기준입력( **r** )근처에서 계속 **진동** 을 하게 됨.

2. Kp가 작으면
    * 제어시스템은 더 느리게 기준입력( **r** )에 도달하게 됨.

* 언젠가 기준입력( **r** )기준으로 일정한 오차( **e** )를 가지며 안정된 상태가 됨.
* 장점 
    * 오차( **e** )는 점점 줄어듬.
* 단점
    * 오차( **e** )가 0이 되지 않고 근사값에 점점 가까워지게 됨.



## 1.3 I제어
* 일정한 상태(정상상태, Steady state)로 유지되는 오차( **e** )를 없애는 방법
* 일정 시간에 걸친 오차( **e** )의 합을 구하고 그 결과를 제어값(MV)에 더함.
    * 단위 시간(dt)에 따른 오차( **e** )의 적분으로 표현
* 적분항에 의해 시간이 지나면 오차( **e** )의 합이 쌓이며    
  제어신호( **u** )는 빠르게 변해 오차( **e** )를 제거함.
  
1. Ki가 크면
    * 제어시스템은 훨씬 더 빨리 기준입력( **r** )에 도달하게 됨.
    * P제어만 할 때보단 파형의 변화량이 크지만    
       오차( **e** )가 0에 가까워지고 기준입력( **r** )과 차이가 없이 안정이 됨.
    * 단, Ki를 너무 높이면 **발산** 을 하게 됨.

2. Ki가 작으면
    * 제어시스템은 더 느리게 기준입력( **r** )에 도달하게 됨.
    * P제어만 할 때보다 진동 없이 기준입력( **r** )점에 도착하여 안정이 됨.

* 장점
    * 오차( **e** )가 0에 매우 가까워짐.
    * P제어만 할 때보다 상승시간(rise time)에 빠르게 도달
* 단점 
    * Overshoot이 크고 정착시간(settling time)에 빠르게 도달 할 수 없는 경우가 많음.

## 1.4 D제어
* 오차( **e** )의 변화율을 계산하고 그 결과를 제어값(MV)에 더함.
    * 단위 시간(dt)에 따른 오차( **e** )의 미분으로 표현

1. 오차( **e** )의 변화가 크지 않는다면
    * 미분항에 의해 D값은 작으며 제어값(MV)에 거의 영향을 미치지 않음.
 
2. 오차( **e** )의 변화가 갑자기 커진다면
    * 미분항에 의해 D값은 커지며 제어값(MV)이 크게 변하는 경우를 막아줌.

* 장점
    * Overshoot 개선 및 정착시간(settling time)에 빠르게 도달 할 수 있도록 해줌.
* 단점
    * 제어시스템이 전체적으로 불안정해질 수 있음.(미세한 **진동** 등)

# 2. PID 제어기 튜닝
## 2.1 Ziegler-Nichols 튜닝 규칙
* 실험적(막말로 노가다)으로 PID제어기를 튜닝하는 방법
* 제어기 튜닝(Controller tuning) : 주어진 성능을 만족시키기 위한    
  제어기 파라미터(Kp,Ki,Kd)를 찾아내는 과정.
* **PID제어기의 미세 튜닝을 위한 시작값을 제공해줌으로 알고있어야함.**
    * Ziegler-Nichols 튜닝을 통해 찾은 값은
        1. 허용할 수 없을 정도의 overshoot를 나타낼 수 있음.
        2. 그에 따른 정착시간(settling time)에 빠르게 도달할 수 없음.
* 결론적으로, 주어진 성능을 만족시키기 한 제어기를 만들기 위해서는
1. Ziegler-Nichols 튜닝을 통해 시작 값을 찾고
2. 여러 번의 미세 튜닝 실험을 반복하여 최종 값을 찾아야함.




